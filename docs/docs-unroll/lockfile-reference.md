---
sidebar_position: 6
title: Lockfile Reference
description: Reference for the unroll.lock lockfile format used for reproducible builds.
keywords: [lockfile, unroll.lock, reproducible builds, pinning, versions]
---

# Lockfile Reference

The lockfile (`unroll.lock`) records the exact versions of all dependencies resolved for your project, ensuring reproducible builds across machines and CI environments.

## Overview

- **Generated automatically** by `unroll add`, `unroll remove`, and `unroll update`
- **Should be committed** to version control for applications
- **Should not be edited** manually (auto-generated)
- **Format version:** 1

## Format

```toml
# This file is auto-generated by Unroll. Do not edit.
# unroll.lock format version 1

[[package]]
name = "@rolls/http"
version = "0.1.5"
source = "registry+https://registry.oite.org/api/v1"
checksum = "sha256:a1b2c3d4e5f6..."
dependencies = [
    "@rolls/async 0.1.2",
    "@rolls/tls 0.1.0"
]

[[package]]
name = "@rolls/async"
version = "0.1.2"
source = "registry+https://registry.oite.org/api/v1"
checksum = "sha256:f6e5d4c3b2a1..."
dependencies = []

[[package]]
name = "@rolls/std"
version = "0.1.0"
source = "registry+https://registry.oite.org/api/v1"
checksum = "sha256:1a2b3c4d5e6f..."
dependencies = [
    "@rolls/string 0.1.0",
    "@rolls/array 0.1.0",
    "@rolls/math 0.1.0",
    "@rolls/json 0.1.0"
]
```

## Fields

### `[[package]]`

Each `[[package]]` section represents a single resolved dependency:

| Field | Type | Description |
|-------|------|-------------|
| `name` | string | Package name (e.g., `"@rolls/http"`) |
| `version` | string | Exact resolved version (e.g., `"0.1.5"`) |
| `source` | string | Where the package was obtained from |
| `checksum` | string | Integrity hash (SHA256) |
| `dependencies` | string[] | Transitive dependencies as `"name version"` pairs |

### Source Format

The `source` field indicates the origin of the package:

| Pattern | Meaning |
|---------|---------|
| `registry+https://registry.oite.org/api/v1` | Official registry |
| `registry+https://custom.registry.com/api/v1` | Custom registry |
| `git+https://github.com/user/repo.git#commit` | Git source (planned) |
| `path+../local-lib` | Local path (planned) |

### Dependency Format

Dependencies are listed as `"name version"` strings:

```toml
dependencies = [
    "@rolls/async 0.1.2",
    "@rolls/tls 0.1.0"
]
```

Empty dependencies use an empty array:

```toml
dependencies = []
```

## Package Ordering

Packages in the lockfile are sorted alphabetically by name. This ensures deterministic output regardless of resolution order, making diffs clean and predictable.

## When Is It Generated?

The lockfile is created or updated when:

| Command | Effect |
|---------|--------|
| `unroll add <pkg>` | Resolves new dependency, adds entries |
| `unroll remove <pkg>` | Re-resolves, removes entries |
| `unroll update` | Re-resolves all dependencies |
| `unroll update <pkg>` | Re-resolves specific package |

## Implicit Standard Library

Unless `no-std` is set, every project implicitly depends on `@rolls/std`. This dependency and its transitives will appear in the lockfile:

```toml
[[package]]
name = "@rolls/std"
version = "0.1.0"
source = "registry+https://registry.oite.org/api/v1"
checksum = "sha256:..."
dependencies = [
    "@rolls/string 0.1.0",
    "@rolls/array 0.1.0",
    "@rolls/math 0.1.0",
    "@rolls/json 0.1.0"
]
```

## Best Practices

### Applications (binaries)

**Commit `unroll.lock` to version control.** This ensures all developers and CI use the exact same dependency versions.

### Libraries

**Generally don't commit `unroll.lock`.** Libraries should allow downstream consumers to resolve compatible versions. The `.gitignore` template excludes `unroll.lock` by default.

### Resolving Lock Conflicts

If `unroll.lock` has merge conflicts, the simplest resolution is:

```bash
# Accept either version, then re-resolve
git checkout --theirs unroll.lock
unroll update
```
